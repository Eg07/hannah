defaults:
    - dataset: kws
    - model: conv-net-trax
    - scheduler: 1cycle
    - optimizer: sgd
    - features: mfcc
    - normalizer: fixedpoint
    - module: stream_classifier
    - compress: null
    - trainer: default
    - checkpoint: default
    - backend: trax_ut
    - early_stopping: null
    - profiler: null
    - hydra/sweeper: hannah


type: train
experiment_id: nas_kws2
output_dir: trained_models
auto_lr: false
seed: [1234]
backend:
  rows: None


monitor: ["val_error", "total_weights",  "acc_clock_cycles", "acc_power", "acc_area"]


hydra:
  run:
    dir: ${output_dir}/${experiment_id}/${model.name}/
  sweep:
    dir: ${output_dir}/${experiment_id}/${model.name}/

  job_logging:
      handlers:
        console:
          level: CRITICAL

  sweeper:
    optim:
      optimizer: aging_evolution
      population_size: 100
      sample_size: 10
      budget:  2000
      seed: 1234
      num_workers:  10
      bounds:
        val_error: 0.05
        total_weights: 100000
        acc_clock_cycles: 20000
        acc_power: 0.00001
        acc_area: 150000




    # default parametrization of the search space
    parametrization:
      backend:
        cols: [4,6,8]
      model:
        qconfig:
          config:
            bw_b: 0
            bw_w: [4,6,8]
            bw_f: [4,6,8]
            power_of_2: [true, false]
        conv:
          min: 2
          max: 4
          choices:
            - target: [forward, residual]
              stride: [1,2,3,4,5,6,7]
              blocks:
                min: 1
                max: 4
                choices:
                  - target: conv1d
                    kernel_size: [1,3,5,7,9]
                    stride: 1
                    act: [false, true]
                    parallel: false
                    norm: true
                    out_channels: [4,8,12,16,20,24,28,32,40,48,56,64]
